<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Visualisierung</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8dcd0 0%, #d4c8b8 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #333;
            text-decoration: none;
            font-weight: bold;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #333;
            color: white;
        }

        .btn-primary:hover {
            background: #555;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            width: 200px;
        }

        .visualization {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 40px 20px;
            min-height: 400px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 4px;
        }

        .bar {
            background: #333;
            border-radius: 4px 4px 0 0;
            transition: all 0.3s;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .bar.comparing {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .bar.swapping {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .bar.sorted {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .bar-value {
            color: white;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .code-section {
            margin: 30px 0;
        }

        .code-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .code-comment { color: #5c6370; }
        .code-keyword { color: #c678dd; }
        .code-function { color: #61afef; }
        .code-number { color: #d19a66; }
        .code-string { color: #98c379; }

        .info-panel {
            background: #f8f9fa;
            color: #333;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-bottom: 20px;
            min-height: 80px;
        }

        .info-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
            min-height: 85px;
        }

        .info-item strong {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #666;
        }

        .info-value {
            font-size: 1.1em;
            color: #333;
            min-height: 2.4em;
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Zurück zur Übersicht</a>

        <div class="header">
            <h1>Bubble Sort Visualisierung</h1>
        </div>

        <div class="description">
            <strong>Funktionsweise:</strong> Bubble Sort durchläuft die Liste mehrmals. Bei jedem Durchlauf werden
            benachbarte Elemente verglichen und getauscht, wenn sie in der falschen Reihenfolge sind. Die größten
            Elemente "blubbern" wie Blasen nach oben (ans Ende).
        </div>

        <div class="controls">
            <button class="btn-primary" onclick="startSort()">Sortierung starten</button>
            <button class="btn-secondary" onclick="resetArray()">Neues Array</button>
            <button class="btn-secondary" onclick="pauseSort()">Pause/Fortsetzen</button>

            <div class="slider-container">
                <label>Geschwindigkeit:</label>
                <input type="range" id="speedSlider" min="10" max="500" value="100" step="10">
                <span id="speedValue">100ms</span>
            </div>

            <div class="slider-container">
                <label>Array-Größe:</label>
                <input type="range" id="sizeSlider" min="5" max="50" value="20" step="1" onchange="resetArray()">
                <span id="sizeValue">20</span>
            </div>
        </div>

        <div class="info-panel">
            <div class="info-title">Aktueller Status</div>
            <div class="info-content">
                <div class="info-item">
                    <strong>Durchlauf:</strong>
                    <div class="info-value" id="currentPass">-</div>
                </div>
                <div class="info-item">
                    <strong>Vergleiche:</strong>
                    <div class="info-value" id="currentComparison">-</div>
                </div>
                <div class="info-item">
                    <strong>Aktion:</strong>
                    <div class="info-value" id="currentAction">Warte auf Start...</div>
                </div>
            </div>
        </div>

        <div class="visualization" id="visualization"></div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="comparisons">0</div>
                <div class="stat-label">Vergleiche</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="swaps">0</div>
                <div class="stat-label">Vertauschungen</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="time">0.0s</div>
                <div class="stat-label">Zeit</div>
            </div>
        </div>

        <div class="code-section">
            <h2>Implementierung in Python</h2>
            <div class="code-block"><span class="code-comment"># Bubble Sort Implementierung in Python</span>

<span class="code-keyword">def</span> <span class="code-function">bubble_sort</span>(arr):
    <span class="code-string">"""
    Sortiert ein Array mit dem Bubble Sort Algorithmus.
    Zeitkomplexität: O(n²)
    Platzkomplexität: O(1)
    """</span>
    n = <span class="code-function">len</span>(arr)

    <span class="code-comment"># Durchlaufe das Array (n-1) mal</span>
    <span class="code-keyword">for</span> i <span class="code-keyword">in</span> <span class="code-function">range</span>(n - <span class="code-number">1</span>):
        swapped = <span class="code-keyword">False</span>

        <span class="code-comment"># Letzte i Elemente sind bereits sortiert</span>
        <span class="code-keyword">for</span> j <span class="code-keyword">in</span> <span class="code-function">range</span>(n - i - <span class="code-number">1</span>):
            <span class="code-comment"># Vergleiche benachbarte Elemente</span>
            <span class="code-keyword">if</span> arr[j] > arr[j + <span class="code-number">1</span>]:
                <span class="code-comment"># Tausche, wenn sie in falscher Reihenfolge sind</span>
                arr[j], arr[j + <span class="code-number">1</span>] = arr[j + <span class="code-number">1</span>], arr[j]
                swapped = <span class="code-keyword">True</span>

        <span class="code-comment"># Wenn keine Vertauschung stattfand, ist Array sortiert</span>
        <span class="code-keyword">if</span> <span class="code-keyword">not</span> swapped:
            <span class="code-keyword">break</span>

    <span class="code-keyword">return</span> arr

<span class="code-comment"># Verwendungsbeispiel</span>
array = [<span class="code-number">64</span>, <span class="code-number">34</span>, <span class="code-number">25</span>, <span class="code-number">12</span>, <span class="code-number">22</span>, <span class="code-number">11</span>, <span class="code-number">90</span>]
<span class="code-function">print</span>(<span class="code-string">"Unsortiert:"</span>, array)
<span class="code-function">bubble_sort</span>(array)
<span class="code-function">print</span>(<span class="code-string">"Sortiert:"</span>, array)</div>
        </div>
    </div>

    <script>
        let array = [];
        let comparisons = 0;
        let swaps = 0;
        let isSorting = false;
        let isPaused = false;
        let startTime = 0;
        let timerInterval = null;

        const visualization = document.getElementById('visualization');
        const speedSlider = document.getElementById('speedSlider');
        const speedValue = document.getElementById('speedValue');
        const sizeSlider = document.getElementById('sizeSlider');
        const sizeValue = document.getElementById('sizeValue');

        speedSlider.addEventListener('input', (e) => {
            speedValue.textContent = e.target.value + 'ms';
        });

        sizeSlider.addEventListener('input', (e) => {
            sizeValue.textContent = e.target.value;
        });

        function generateArray(size) {
            const arr = [];
            for (let i = 0; i < size; i++) {
                arr.push(Math.floor(Math.random() * 100) + 10);
            }
            return arr;
        }

        function renderArray() {
            visualization.innerHTML = '';
            const maxValue = Math.max(...array);
            const barWidth = Math.max(10, Math.min(40, (visualization.offsetWidth - array.length * 4) / array.length));

            array.forEach((value, index) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${(value / maxValue) * 300}px`;
                bar.style.width = `${barWidth}px`;
                bar.id = `bar-${index}`;

                const barValue = document.createElement('div');
                barValue.className = 'bar-value';
                barValue.textContent = value;
                bar.appendChild(barValue);

                visualization.appendChild(bar);
            });
        }

        function updateStats() {
            document.getElementById('comparisons').textContent = comparisons;
            document.getElementById('swaps').textContent = swaps;
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(() => {
                if (!isPaused) {
                    const elapsed = (Date.now() - startTime) / 1000;
                    document.getElementById('time').textContent = elapsed.toFixed(1) + 's';
                }
            }, 100);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        async function sleep(ms) {
            const startTime = Date.now();
            while (Date.now() - startTime < ms) {
                if (isPaused) {
                    while (isPaused && isSorting) {
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                }
                if (!isSorting) return;
                await new Promise(resolve => setTimeout(resolve, 50));
            }
        }

        async function animateSwap(idx1, idx2) {
            const bar1 = document.getElementById(`bar-${idx1}`);
            const bar2 = document.getElementById(`bar-${idx2}`);

            if (!bar1 || !bar2) return;

            const distance = (idx2 - idx1) * (bar1.offsetWidth + 4);

            bar1.style.transform = `translateX(${distance}px)`;
            bar2.style.transform = `translateX(${-distance}px)`;

            await new Promise(resolve => setTimeout(resolve, 300));

            bar1.style.transform = '';
            bar2.style.transform = '';
        }

        function updateInfo(pass, comparison, action) {
            document.getElementById('currentPass').textContent = pass;
            document.getElementById('currentComparison').textContent = comparison;
            document.getElementById('currentAction').textContent = action;
        }

        async function bubbleSort() {
            const n = array.length;

            for (let i = 0; i < n - 1; i++) {
                let swapped = false;
                updateInfo(i + 1, '-', `Durchlauf ${i + 1} von ${n - 1}`);

                for (let j = 0; j < n - i - 1; j++) {
                    if (!isSorting) return;

                    const bar1 = document.getElementById(`bar-${j}`);
                    const bar2 = document.getElementById(`bar-${j + 1}`);

                    bar1.classList.add('comparing');
                    bar2.classList.add('comparing');

                    comparisons++;
                    updateStats();
                    updateInfo(i + 1, `${array[j]} vs ${array[j + 1]}`, 'Vergleiche Elemente...');

                    await sleep(parseInt(speedSlider.value));

                    if (array[j] > array[j + 1]) {
                        bar1.classList.remove('comparing');
                        bar2.classList.remove('comparing');
                        bar1.classList.add('swapping');
                        bar2.classList.add('swapping');

                        updateInfo(i + 1, `${array[j]} vs ${array[j + 1]}`, `Tausche ${array[j]} ↔ ${array[j + 1]}`);

                        await animateSwap(j, j + 1);

                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                        swaps++;
                        updateStats();
                        swapped = true;

                        renderArray();
                    } else {
                        bar1.classList.remove('comparing');
                        bar2.classList.remove('comparing');
                        updateInfo(i + 1, `${array[j]} vs ${array[j + 1]}`, 'Kein Tausch nötig');
                    }
                }

                const sortedBar = document.getElementById(`bar-${n - i - 1}`);
                if (sortedBar) {
                    sortedBar.classList.add('sorted');
                }
                updateInfo(i + 1, '-', `Element ${array[n - i - 1]} ist sortiert`);
                await sleep(parseInt(speedSlider.value) / 2);

                if (!swapped) break;
            }

            for (let i = 0; i < array.length; i++) {
                const bar = document.getElementById(`bar-${i}`);
                if (bar) {
                    bar.classList.add('sorted');
                }
            }

            updateInfo('✓', '-', 'Sortierung abgeschlossen!');
            isSorting = false;
            stopTimer();
        }

        async function startSort() {
            if (isSorting) return;

            isSorting = true;
            isPaused = false;
            comparisons = 0;
            swaps = 0;
            updateStats();
            startTimer();

            await bubbleSort();
        }

        function pauseSort() {
            isPaused = !isPaused;
        }

        function resetArray() {
            isSorting = false;
            isPaused = false;
            stopTimer();
            comparisons = 0;
            swaps = 0;
            document.getElementById('time').textContent = '0.0s';
            updateStats();
            updateInfo('-', '-', 'Warte auf Start...');

            const size = parseInt(sizeSlider.value);
            array = generateArray(size);
            renderArray();
        }

        resetArray();
    </script>
</body>
</html>
